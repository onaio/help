<!DOCTYPE html>
<html lang="en-US">
  <head>
<title>Encrypted Forms</title>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="description" content="This is the Ona help page.
"/>
<meta name="author" content="Ona"/>

<link rel="shortcut icon" href="/favicon.ico"/>

<link href="/assets/css/bootstrap.min.css" rel="stylesheet"/>
<link href="/assets/css/help.css" rel="stylesheet"/>
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>

<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>

   <body>
       <header class="navbar navbar-inverse" role="navigation" id="helpnav">
    <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">
              <img src="/assets/img/ona-logo.png" alt="Onadata Logo"/>
          </a>
        </div>
        
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
              <li><a class="active" href="#faqs">faqs</a></li>
              <li><a href="#guides">guides</a></li>
              <li><a href="#">tutorial</a></li>
              <li><a href="http://blog.ona.io/">blog</a></li>
              <li><a href="http://ona.io/accounts/register/">signup</a></li>
          </ul>
        </div>
    </div>
</header>
   
       <div class="jumbotron">
    <div class="container">
        <h3 class="qa-header">Encrypted Forms</h3>
    </div>
</div>

<div class="container content">
    <div class="qa-row clearfix">
        <div class="col-md-8">
            <h3 id="span-iddata-encryptionspanhow-does-data-encryption-work"><span id="data-encryption"></span>How does data encryption work?</h3>

<p>You can encrypt form submissions to the Ona server using ODK Collect (encryption is not yet supported in Enketo webforms). Encrypted forms are useful for projects that have strict data security requirements from ethical review boards.</p>

<h3 id="how-does-it-work">How does it work?</h3>

<p>Forms are encrypted on your mobile device once they are marked as finalized in ODK Collect. The data remains encrypted on your mobile device until it is uploaded to the Ona server.  Once the form is submitted, Ona serves as a storage locker for your encrypted files - they are safely stored and encrypted on the server until they are downloaded and decrypted using ODK Briefcase.  Since the form submissions on Ona are encrypted, you will not be able to use the view data features in your account, such as the map view or table maker, and you will not be able to download data in csv or xls formats within Ona.</p>

<h3 id="encryption-keys">Encryption keys</h3>

<p>In order to encrypt your form, you need to generate public and private encryption keys:</p>

<ul>
  <li>the <strong>public key</strong> is included in your XLSForm, as described below;</li>
  <li>the <strong>private key</strong> (which you never share) is pulled into ODK Briefcase to decrypt the data locally after you’ve downloaded it from Ona.</li>
</ul>

<p>The public key is used to encrypt your form data while the private key decrypts it. Anyone with the private key can decrypt the data, so keep the private key in a secure place. To understand more about public and private key infrastructure, check out <a href="http://en.wikipedia.org/wiki/Public-key_cryptography">this page</a> on Wikipedia.</p>

<p>To generate your private and public encryption keys, you can use the OpenSSL software package.  This software comes pre-installed on OSX and Linux systems, and it can be downloaded <a href="http://slproweb.com/products/Win32OpenSSL.html">here</a> for Windows.  Instructions on generating key-pairs using OpenSSL software can be found at <a href="http://opendatakit.org/help/encrypted-forms/">this ODK site</a>.</p>

<h3 id="xlsform-syntax-for-encrypted-forms">XLSForm syntax for encrypted forms</h3>

<p>Follow these steps to add the correct encryption syntax in your XLSForm:</p>

<ol>
  <li>Add a worksheet called <strong>settings</strong>;</li>
  <li>In this worksheet, create three columns: <strong>id_string</strong>, <strong>submission_url</strong>, and <strong>public_key</strong>. The <strong>id_string</strong> column specifies the form id name.  The <strong>submission_url</strong> is the url that will accept the encrypted form submissions.  This is the same url that you type into the ODK Collect application under settings to download the forms from your account; however, you must add <strong>/submission</strong> to the end of this url.  Finally, the <strong>public_key</strong> column contains the public key (without any spaces or line breaks) that was generated using the OpenSSL software.
<br />
<img src="https://farm4.staticflickr.com/3925/15162494098_d44d69d71b.jpg" alt="" />
<br /><br /></li>
  <li>Upload the XLSForm to Ona as usual. You should see a label with the text <strong>ENCRYPTED</strong> next to your form name on Ona, as illustrated in the image below:
<br /><br />
<img src="https://farm4.staticflickr.com/3885/15162494168_9a428fb56a.jpg" alt="" />
<br /><br /></li>
  <li>Download your encrypted form to your mobile phone using ODK Collect and start collecting data!
<br /><br />
<img src="" alt="" /></li>
</ol>

<h3 id="how-to-decrypt-your-form">How to decrypt your form</h3>

<p>You must use ODK Briefcase to download the encrypted files from Ona and decrypt them locally on your computer using the private key generated earlier. Follow these steps to download ODK Briefcase and decrypt your data:</p>

<ol>
  <li>Create a folder on your local machine to store the data once it is decrypted;</li>
  <li>If you haven’t already done so, download <a href="http://opendatakit.org/use/briefcase/">ODK Briefcase</a> to your local machine;</li>
  <li>Double click the downloaded file to open ODK Briefcase;</li>
  <li><strong>PULL</strong> the encrypted form to your local machine.  See the ODK Briefcase page for more information on how to pull forms.</li>
  <li>The form is decrypted only during export. Go to the <strong>Export</strong> tab;
<br /><br />
<img src="https://farm4.staticflickr.com/3874/15162544187_67d921e139.jpg" alt="" />
<br /><br /></li>
  <li>Select the form from the <strong>Form</strong> dropdown;
<br /><br />
<img src="https://farm4.staticflickr.com/3858/15348761702_ef299d25bb.jpg" alt="" />
<br /><br /></li>
  <li>On the <strong>Export Type</strong> dropdown, select <strong>.csv</strong> and <strong>media files</strong>;
<br /><br />
<img src="https://farm3.staticflickr.com/2943/15348761732_e2e89bd634.jpg" alt="" />
<br /><br /></li>
  <li>Locate the <strong>Export Directory</strong>, which is the folder you created in step 1;
<br /><br />
<img src="https://farm4.staticflickr.com/3927/15162313579_383bec78e2.jpg" alt="" />
<br /><br /></li>
  <li>Search for and choose the <strong>PEM Private Key File</strong> that you generated previously;</li>
  <li>Click on <strong>Export</strong>. The form data will be decrypted and exported to the folder you created in step 1.
<br /><br />
<img src="https://farm3.staticflickr.com/2941/15349066455_dd6745eba9.jpg" alt="" /></li>
</ol>

        </div>
        
        <div class="col-md-3 clearfix sidenav qa-nav pull-right">
            <h5>Popular Questions</h5>
            
                <li><a href="/faq/odk-briefcase">ODK Briefcase Faq</a></li>
            
                <li><a href="/faq/encrypted-forms">Encrypted Forms</a></li>
            
        </div>
    </div>
</div>

       <div class="container">
    <footer>
        <p>
            &copy; Help | Ona.io 2014 <br/>
            <a href="mailto:support@ona.io">support@ona.io</a>
        </p>
    </footer>
</div>

<script src="/assets/js/jquery-1.11.1.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>
<script>
$(document).ready(function(){
    $("#guide-holder .post-area > ul:first-child").appendTo(".guide-nav");    
});
</script> 
   </body>
</html>